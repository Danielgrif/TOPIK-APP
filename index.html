<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TOPIK II - Master Pro 2026</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="./favicon.svg" type="image/svg+xml">
    <meta name="theme-color" content="#6c5ce7">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/themes.css" />
    <link rel="stylesheet" href="css/animations.css" />
    <audio id="music-player-a" loop preload="auto"></audio>
    <audio id="music-player-b" loop preload="auto"></audio>
  </head>
  <body>
    <!-- Main App Wrapper -->
    <div id="app-container">
    
    <!-- Exit Focus Mode Button -->
    <button id="exit-focus-btn" class="btn" data-action="toggle-focus">‚úï –í—ã–π—Ç–∏ –∏–∑ —Ñ–æ–∫—É—Å–∞</button>

    <!-- Toast Notifications -->
    <div
      id="toast-container"
      style="
        position: fixed;
        right: 16px;
        bottom: 16px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 20000;
      "
    ></div>

    <!-- Critical Error Overlay -->
    <div id="error-overlay">
      <div>
        <h2>–û—à–∏–±–∫–∞ Supabase</h2>
        <p id="error-msg"></p>
        <button class="btn" data-action="reload">–û–±–Ω–æ–≤–∏—Ç—å</button>
      </div>
    </div>

    <!-- Main Header with XP Bar -->
    <div id="main-header">
      <div class="header-top-row">
        <div id="profile-button" data-modal-target="profile-modal">
          <div class="avatar" id="profile-avatar">üë§</div>
          <div class="profile-info-col">
            <div id="profile-name">–ì–æ—Å—Ç—å</div>
            <div class="level-badge-header">LVL <span id="user-level">1</span></div>
          </div>
        </div>
        <div class="header-actions">
          <button class="coin-pill" data-modal-target="shop-modal"><span id="coins-count-header">0</span> üí∞</button>
          <button id="header-dark-mode-toggle" class="theme-btn-header" data-action="toggle-dark-mode">‚òÄÔ∏è</button>
        </div>
      </div>
      <div id="xp-level-widget" data-modal-target="stats-modal">
        <div class="xp-track"><div class="xp-bar-fill" id="xp-fill"></div></div>
        <div class="xp-label" id="xp-text">0 / 100 XP</div>
      </div>
    </div>

    <!-- Main Content Area -->
    <main id="main-content">

      <!-- Search and Filter Toolbar -->
      <div class="content-toolbar">
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="–ü–æ–∏—Å–∫..." />
            <div class="search-icon">üîç</div>
        </div>
        <div class="toolbar-actions">
            <div class="view-toggles">
                <button class="view-btn active" data-action="toggle-view" data-value="grid">‚ñ¶</button>
                <button class="view-btn" data-action="toggle-view" data-value="list">‚ò∞</button>
            </div>
            <button class="tool-btn fire-btn" data-action="start-daily-challenge">üî•</button>
            <button class="tool-btn" data-action="toggle-filter-panel">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
            </button>
            <button id="focus-mode-btn" class="tool-btn" data-action="toggle-focus">üëÅÔ∏è</button>
        </div>
      </div>

      <div id="vocabulary-grid" class="grid"></div>
    </main>

    <!-- Floating Action Button for Adding Words -->
    <button class="fab-btn" data-modal-target="add-word-modal" title="–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–ª–æ–≤–æ">+</button>

    </div> <!-- End of #app-container -->

    <!-- Filter Panel (hidden by default) -->
    <div id="filter-panel">
      <div class="filter-panel-header">
        <h3>üîç –§–∏–ª—å—Ç—Ä—ã</h3>
        <button class="btn btn-icon close-modal-btn" data-action="toggle-filter-panel">‚úï</button>
      </div>
      <div class="filter-panel-content">
        <div class="filter-section">
          <div class="filter-label">–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞</div>
          <div class="segment-control" id="type-filters">
              <button class="segment-btn active" data-action="set-type-filter" data-value="word">üìñ –°–ª–æ–≤–∞</button>
              <button class="segment-btn" data-action="set-type-filter" data-value="grammar">üìò –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞</button>
          </div>
        </div>
        <div class="filter-section">
          <div class="filter-label">–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</div>
          <div class="filter-chips" id="level-filters">
              <button class="filter-chip active" data-action="set-star-filter" data-value="all">–í—Å–µ</button>
              <button class="filter-chip" data-action="set-star-filter" data-value="‚òÖ‚òÖ‚òÖ">‚òÖ‚òÖ‚òÖ</button>
              <button class="filter-chip" data-action="set-star-filter" data-value="‚òÖ‚òÖ‚òÜ">‚òÖ‚òÖ‚òÜ</button>
              <button class="filter-chip" data-action="set-star-filter" data-value="‚òÖ‚òÜ‚òÜ">‚òÖ‚òÜ‚òÜ</button>
              <button class="filter-chip fav-chip" data-action="set-star-filter" data-value="favorites">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
          </div>
        </div>
        <div class="filter-section">
          <div class="filter-label">–¢–µ–º–∞</div>
          <div id="topicSelect" class="custom-select-container"></div>
        </div>
        <div class="filter-section">
          <div class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</div>
          <div class="custom-select-wrapper">
            <select id="categorySelect" class="custom-select" onchange="handleCategoryChange(this.value)">
                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            </select>
            <div class="select-arrow">‚ñº</div>
          </div>
        </div>
        <div class="filter-section">
          <div class="filter-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</div>
          <div class="sort-actions">
            <button class="sort-btn" data-action="sort-weak">
                <span class="sort-icon">üí™</span>
                <span>–°–ª–∞–±—ã–µ</span>
            </button>
            <button class="sort-btn" data-action="shuffle">
                <span class="sort-icon">üîÄ</span>
                <span>–ü–µ—Ä–µ–º–µ—à–∞—Ç—å</span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="filter-panel-overlay" data-action="toggle-filter-panel"></div>

    <!-- Bottom Navigation Bar -->
    <div id="bottom-nav">
      <button class="nav-btn active" onclick="document.getElementById('main-content').scrollTo({top: 0});">
        <span class="nav-icon">üè†</span><span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
      </button>
      <button class="nav-btn" data-modal-target="quiz-modal">
        <span class="nav-icon">üéÆ</span><span class="nav-label">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</span>
      </button>
      <button class="nav-btn" data-action="open-review">
        <span class="nav-icon">üîÅ</span><span class="nav-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</span>
        <span id="srs-badge" class="badge-count">0</span>
      </button>
      <button class="nav-btn" data-modal-target="stats-modal">
        <span class="nav-icon">üìä</span><span class="nav-label">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
      </button>
      <button class="nav-btn" data-modal-target="profile-modal">
        <span class="nav-icon">üë§</span><span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
      </button>
    </div>

    <!-- Stats Modal -->
    <div
      id="stats-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="stats-modal"
    >
      <div class="modal-content">
        <div class="modal-body-container wide">
          <div class="modal-header">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="header-actions">
              <div id="stats-theme-picker" style="display:flex; gap:6px; margin-right:10px; align-items: center;">
                  <button class="stats-color-btn" data-action="set-accent" data-value="purple" style="background:#6c5ce7"></button>
                  <button class="stats-color-btn" data-action="set-accent" data-value="blue" style="background:#0984e3"></button>
                  <button class="stats-color-btn" data-action="set-accent" data-value="green" style="background:#00b894"></button>
                  <button class="stats-color-btn" data-action="set-accent" data-value="orange" style="background:#e17055"></button>
                  <button class="stats-color-btn" data-action="set-accent" data-value="pink" style="background:#e84393"></button>
              </div>
              <button class="btn" data-action="share-stats" style="padding: 6px 12px; font-size: 13px; display: flex; align-items: center; gap: 6px;">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
              <button class="btn btn-icon close-modal-btn" data-close-modal="stats-modal">‚úï</button>
            </div>
          </div>

        <div id="stats-strip" class="stats-strip"></div>

        <div id="stats-details"></div>
        <div id="topic-mastery"></div>
        <div style="font-weight: 600; margin-top: 20px">
          üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
        </div>
        <div id="activity-chart" class="chart-container"></div>
        <div style="font-weight: 600; margin-top: 20px">
          üìÖ –ò–∑—É—á–µ–Ω–æ —Å–ª–æ–≤ (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
        </div>
        <div id="learned-chart" class="chart-container"></div>
        <div style="font-weight: 600; margin-top: 20px">
          üìâ –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞–±—ã–≤–∞–Ω–∏—è (–∫–æ–≥–¥–∞ –ø–æ–≤—Ç–æ—Ä—è—Ç—å)
        </div>
        <div id="forgetting-chart" class="chart-container" style="grid-template-columns: repeat(15, 1fr);"></div>
        <div style="font-weight: 600; margin-top: 20px">
          üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SRS
        </div>
        <div id="srs-distribution-chart" class="chart-container"></div>
        </div>
      </div>
    </div>

    <!-- Hanja Explorer Modal -->
    <div
      id="hanja-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="hanja-modal"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="hanja-title">Hanja</h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="hanja-modal">‚úï</button>
          </div>
        </div>
        <div id="hanja-list" class="hanja-list"></div>
      </div>
    </div>

    <!-- Shop Modal -->
    <div
      id="shop-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="shop-modal"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h3>üõí –ú–∞–≥–∞–∑–∏–Ω <span id="shop-balance" class="coin-balance">0</span></h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="shop-modal">‚úï</button>
          </div>
        </div>
        <div id="shop-items" class="shop-grid"></div>
      </div>
    </div>

    <!-- Grammar Detail Modal -->
    <div
      id="grammar-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="grammar-modal"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="grammar-title">–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞</h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="grammar-modal">‚úï</button>
          </div>
        </div>
        <div id="grammar-content" class="grammar-content"></div>
      </div>
    </div>

    <!-- Achievements Modal -->
    <div
      id="achievements-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="achievements-modal"
    >
      <div class="modal-content">
        <div class="modal-body-container">
          <div class="modal-header">
            <h3>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
            <div class="header-actions">
              <button class="btn btn-icon close-modal-btn" data-close-modal="achievements-modal">‚úï</button>
            </div>
          </div>
          <div id="achievements-header" style="text-align: center; margin-bottom: 20px;">
            <!-- Progress will be injected here -->
          </div>
        <div id="achievements-list" class="achievement-grid"></div>
        </div>
      </div>
    </div>

    <!-- Confirm Modal (replaces window.confirm) -->
    <div
      id="confirm-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-action="close-confirm"
    >
      <div class="modal-content" style="text-align: center; position: relative;">
        <button class="btn btn-icon close-modal-btn" data-action="close-confirm" style="position: absolute; top: 15px; right: 15px; z-index: 1;">‚úï</button>
        <div style="font-size: 20px; font-weight: 800; margin-bottom: 10px;">‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
        <div style="margin-bottom: 20px; color: var(--text-sub); line-height: 1.5;" id="confirm-message">–í—ã —É–≤–µ—Ä–µ–Ω—ã?</div>
        <div id="confirm-input-container" style="display: none; margin-bottom: 15px;">
            <input type="password" id="confirm-password" class="search-box" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="width: 100%; text-align: center;">
        </div>
        <div style="display: flex; gap: 10px;">
          <button class="btn" id="confirm-no" data-action="close-confirm" style="flex: 1; justify-content: center;">
            –û—Ç–º–µ–Ω–∞
          </button>
          <button class="btn btn-quiz" id="confirm-yes" style="flex: 1; justify-content: center;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- Quiz Modal -->
    <div
      id="quiz-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      tabindex="-1"
      data-close-modal="quiz-modal"
    >
      <div class="modal-content">
        <div class="modal-body-container">
          <div class="modal-header">
            <h3>üéÆ –†–µ–∂–∏–º—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
            <div class="header-actions">
              <button class="btn btn-icon close-modal-btn" data-close-modal="quiz-modal">‚úï</button>
            </div>
          </div>
        <input type="text" id="quiz-search-input" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ —Å–ª–æ–≤ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏..." style="width: 100%; margin-bottom: 12px; box-sizing: border-box; padding: 10px 15px;">
        <div
          id="quiz-filters"
          style="margin-bottom: 12px; display: flex; gap: 8px"
        >
          <select
            id="quiz-topic-select"
            class="search-box"
            style="padding: 8px; font-size: 13px; flex: 1"
          ></select>
          <select
            id="quiz-category-select"
            class="search-box"
            style="padding: 8px; font-size: 13px; flex: 1"
          ></select>
        </div>
        <div
          id="quiz-difficulty"
          style="margin-bottom: 12px; display: flex; gap: 8px; flex-wrap: wrap"
        ></div>
        <div
          id="quiz-count"
          style="margin-bottom: 12px; color: var(--text-sub); font-weight: 600"
        >
          –°–ª–æ–≤: 0
        </div>
        <div class="quiz-modes" id="quiz-mode-selector"></div>
        <div id="quiz-game">
          <div class="quiz-header">
            <div id="quiz-score" class="quiz-meta-item">–í–æ–ø—Ä–æ—Å 1/10</div>
            <div class="quiz-progress-container">
              <div class="quiz-progress-fill" id="quiz-progress-fill"></div>
            </div>
            <div id="quiz-timer-display" class="quiz-meta-item">00:00</div>
          </div>
          <div class="quiz-body">
            <div class="quiz-question" id="quiz-q"></div>
            <div class="quiz-options" id="quiz-opts"></div>
          </div>
          <div class="quiz-footer"><button class="btn btn-text-only" data-action="quit-quiz">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button></div>
        </div>
        </div>
      </div>
    </div>

    <!-- Custom PWA Install Banner -->
    <div id="install-banner" class="install-banner">
        <div class="install-content">
            <div class="install-icon">üì≤</div>
            <div class="install-text">
                <div class="install-title">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
                <div class="install-desc">–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å –æ—Ñ–ª–∞–π–Ω –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
            </div>
        </div>
        <div class="install-actions">
            <button class="btn-text" data-action="dismiss-banner">–ü–æ–∑–∂–µ</button>
            <button class="btn btn-quiz" data-action="install-app">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- Level Up Overlay -->
    <div id="level-up-overlay" class="level-up-overlay">
        <div class="level-up-content">
            <div class="level-up-icon">üéâ</div>
            <div class="level-up-title">–ù–û–í–´–ô –£–†–û–í–ï–ù–¨!</div>
            <div class="level-up-val" id="level-up-val">5</div>
            <button class="btn btn-quiz" data-action="close-level-up">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <!-- Add Word Modal -->
    <div id="add-word-modal" class="modal" role="dialog" aria-modal="true" tabindex="-1" data-close-modal="add-word-modal">
      <div class="modal-content modal-centered">
        <div class="modal-header">
          <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ</h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="add-word-modal">‚úï</button>
          </div>
        </div>
        <div style="margin-bottom: 20px; color: var(--text-sub); font-size: 14px; line-height: 1.5;">
          –í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ –∫–æ—Ä–µ–π—Å–∫–æ–º. –ù–∞—à AI –Ω–∞–π–¥–µ—Ç –ø–µ—Ä–µ–≤–æ–¥, –ø—Ä–∏–º–µ—Ä—ã –∏ –æ–∑–≤—É—á–∫—É, –ø–æ—Å–ª–µ —á–µ–≥–æ –¥–æ–±–∞–≤–∏—Ç –µ–≥–æ –≤ –æ–±—â—É—é –±–∞–∑—É.
        </div>
        <input type="text" id="new-word-input" class="search-box" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ÌïôÍµê" style="width: 100%; margin-bottom: 20px;">
        <button class="btn btn-quiz" data-action="submit-word-request" style="width: 100%;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
      </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal" role="dialog" aria-modal="true" tabindex="-1" data-close-modal="login-modal">
      <div class="modal-content modal-centered" style="text-align: center;">
        <div style="margin: auto; width: 100%; max-width: 400px;">
        <div class="modal-header">
          <h3 id="auth-title">üîê –ü—Ä–æ—Ñ–∏–ª—å</h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="login-modal">‚úï</button>
          </div>
        </div>
        <div id="auth-desc" style="margin-bottom: 20px; color: var(--text-sub); font-size: 14px; line-height: 1.5;">
          –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –æ–±–ª–∞–∫–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
        </div>
        <input type="email" id="auth-email" class="search-box" placeholder="Email" style="width: 100%; margin-bottom: 10px; box-sizing: border-box;">
        
        <div id="auth-password-container" style="position: relative; margin-bottom: 20px;">
            <input type="password" id="auth-password" class="search-box" placeholder="–ü–∞—Ä–æ–ª—å" style="width: 100%; box-sizing: border-box; padding-right: 40px;">
            <span data-action="toggle-password" id="toggle-password-btn" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 18px; user-select: none; opacity: 0.6;" title="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅÔ∏è</span>
            <div class="password-strength"><div id="strength-bar"></div></div>
        </div>
        
        <div id="auth-buttons" style="display: flex; gap: 10px;">
          <button class="btn btn-quiz" data-action="auth" data-value="login" style="flex: 1;">–í–æ–π—Ç–∏</button>
          <button class="btn" data-action="auth" data-value="signup" style="flex: 1;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
        <div id="auth-reset-buttons" style="display: none;">
            <button class="btn btn-quiz" data-action="auth" data-value="reset" style="width: 100%;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É</button>
        </div>
        
        <div id="auth-social" style="margin-top: 20px;">
            <div class="auth-separator"><span>–ò–õ–ò</span></div>
            <button class="btn google-btn" data-action="auth-google">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="G">
                <span>–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</span>
            </button>
        </div>

        <div style="margin-top: 15px; font-size: 13px;">
          <a href="#" id="auth-forgot-link" data-action="toggle-reset-mode" data-value="true" style="color: var(--primary); text-decoration: none; border-bottom: 1px dashed var(--primary);">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
          <a href="#" id="auth-back-link" data-action="toggle-reset-mode" data-value="false" style="color: var(--text-sub); text-decoration: none; border-bottom: 1px dashed var(--text-sub); display: none;">‚Üê –ù–∞–∑–∞–¥ –∫–æ –≤—Ö–æ–¥—É</a>
        </div>
        <div id="auth-error" style="color: var(--danger); margin-top: 15px; font-size: 13px; display: none; font-weight: bold;"></div>
        </div>
      </div>
    </div>

    <!-- Profile Modal -->
    <div id="profile-modal" class="modal" role="dialog" aria-modal="true" tabindex="-1" data-close-modal="profile-modal">
      <div class="modal-content modal-centered" style="text-align: center;">
        <div class="modal-body-container">
        <div class="modal-header">
          <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
          <div class="header-actions">
            <button class="btn btn-icon close-modal-btn" data-close-modal="profile-modal">‚úï</button>
          </div>
        </div>
        
        <!-- User Info -->
        <div style="text-align: center; margin-bottom: 20px;">
            <div class="avatar" id="profile-avatar-large" style="width: 80px; height: 80px; font-size: 40px; margin: 0 auto 10px;">üë§</div>
            <div id="profile-email" style="font-weight: 800; font-size: 18px;">guest@example.com</div>
            <div style="font-size: 13px; color: var(--text-sub); margin-top: 5px;">–°—Ç—É–¥–µ–Ω—Ç</div>
        </div>

        <!-- Appearance -->
        <div class="settings-group">
            <div class="setting-item">
                <span class="setting-icon">üåô</span>
                <span class="setting-label">–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º</span>
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle-switch" data-action="toggle-dark-mode">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item" style="flex-direction: column; align-items: flex-start; gap: 10px;">
                <div style="display: flex; align-items: center; width: 100%;">
                    <span class="setting-icon">üé®</span>
                    <span class="setting-label">–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞</span>
                </div>
                <div style="display: flex; gap: 12px; width: 100%; justify-content: space-between; padding: 0 5px;">
                <button class="color-option" data-action="set-accent" data-value="purple" style="background: #6c5ce7;"></button>
                <button class="color-option" data-action="set-accent" data-value="blue" style="background: #0984e3;"></button>
                <button class="color-option" data-action="set-accent" data-value="green" style="background: #00b894;"></button>
                <button class="color-option" data-action="set-accent" data-value="orange" style="background: #e17055;"></button>
                <button class="color-option" data-action="set-accent" data-value="pink" style="background: #e84393;"></button>
                </div>
            </div>
        </div>

        <!-- Learning -->
        <div class="settings-group">
            <div class="setting-item">
                <span class="setting-icon">üâê</span>
                <span class="setting-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å Hanja</span>
                <label class="switch">
                  <input type="checkbox" id="hanja-setting-check" data-action="toggle-hanja">
                  <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span class="setting-icon">üó£Ô∏è</span>
                <span class="setting-label">–ì–æ–ª–æ—Å –æ–∑–≤—É—á–∫–∏</span>
                <button id="voice-setting-btn" class="btn" data-action="toggle-voice" style="padding: 6px 12px; font-size: 13px;">üë© –ñ–µ–Ω—Å–∫–∏–π</button>
            </div>
            <div class="setting-item" style="flex-direction: column; align-items: flex-start; gap: 10px;">
                <div style="display: flex; align-items: center; width: 100%;">
                    <span class="setting-icon">‚è©</span>
                    <span class="setting-label">–°–∫–æ—Ä–æ—Å—Ç—å –æ–∑–≤—É—á–∫–∏</span>
                    <span id="speed-val" style="font-weight: bold; font-size: 14px; color: var(--primary);">1.0x</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; width: 100%;">
                    <span style="font-size: 14px;">üê¢</span>
                    <input type="range" id="speed-slider" min="0.5" max="1.5" step="0.1" value="0.9" style="flex: 1;" data-action="set-speed">
                    <span style="font-size: 14px;">üêá</span>
                </div>
            </div>
        </div>

        <!-- Audio -->
        <div class="settings-group">
            <div class="setting-item">
                <span class="setting-icon">üéµ</span>
                <span class="setting-label">–§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞</span>
                <label class="switch">
                  <input type="checkbox" id="background-music-check" data-action="toggle-music">
                  <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item" style="padding-top: 5px;">
                <span class="setting-icon">üîä</span>
                <input type="range" id="background-music-volume-slider" min="0" max="1" step="0.05" value="0.3" style="flex: 1; margin: 0 10px;" data-action="set-music-volume">
                <span id="background-music-volume-val" style="font-weight: bold; font-size: 13px; width: 35px; text-align: right;">30%</span>
            </div>
        </div>
        
        <!-- System -->
        <div class="settings-group">
            <button id="install-app-btn" class="btn" data-action="install-app" style="width: calc(100% - 30px); margin: 15px; background: var(--primary); color: white; display: none; justify-content: center;">üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
            <div class="setting-item">
                <span class="setting-icon">üîÑ</span>
                <span class="setting-label">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
                <label class="switch">
                  <input type="checkbox" id="auto-update-check" data-action="toggle-auto-update">
                  <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item" data-modal-target="achievements-modal" style="cursor: pointer;">
                <span class="setting-icon">üèÜ</span>
                <span class="setting-label">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
                <span style="color: var(--text-sub);">‚Ä∫</span>
            </div>
        </div>

        <!-- Data Actions -->
        <div class="settings-group">
            <div class="setting-item" data-action="export-data" style="cursor: pointer;">
                <span class="setting-icon">üíæ</span>
                <span class="setting-label">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
            </div>
            <div class="setting-item" onclick="document.getElementById('import-file').click()" style="cursor: pointer;">
                <span class="setting-icon">üìÇ</span>
                <span class="setting-label">–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
            </div>
            <div class="setting-item" data-action="clear-data" style="cursor: pointer;">
                <span class="setting-icon">üóë</span>
                <span class="setting-label" style="color: var(--danger);">–°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span>
            </div>
        </div>

        <!-- Account -->
        <div class="settings-group">
            <div class="setting-item" data-action="logout" style="cursor: pointer;">
                <span class="setting-icon">üö™</span>
                <span class="setting-label" style="color: var(--danger);">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</span>
            </div>
        </div>
        
        <!-- Password Change -->
        <div class="settings-group">
             <div class="setting-item" style="flex-direction: column; align-items: stretch;">
                <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px;">üîê –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</div>
                <div style="display: flex; gap: 10px;">
                    <input type="password" id="new-password" class="search-box" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" style="flex: 1; padding: 8px 12px; font-size: 14px;">
                    <button class="btn" data-action="change-password" style="padding: 8px 12px;">OK</button>
                </div>
                <div class="password-strength" id="new-strength-container" style="margin-top: 5px;"><div id="new-strength-bar"></div></div>
             </div>
        </div>

        <div id="app-version" style="text-align: center; font-size: 11px; color: var(--text-sub); margin-top: 10px; opacity: 0.5;"></div>
        </div>
      </div>
    </div>

    <div id="scroll-indicator"></div>

    <input type="file" id="import-file" style="display: none" onchange="importProgress(event)" />

    <script type="module" src="js/app.js"></script>
  </body>
</html>
